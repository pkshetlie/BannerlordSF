{% extends 'base.html.twig' %}
{% block stylesheets %}
    {{ parent() }}
    {{ encore_entry_link_tags('home') }}
{% endblock %}
{% block body %}
    <main class="wrapper">

        <section class="section-parallax parallax-background bg1 home-title">
            <h1>{{ challenge.title }}</h1>
        </section>

        {# ================ Structure de test ! ================ #}

        {# infos globales/inscription #}
        <section class="section-parallax static challenge-global">
            <div class="container">
                <div class="row">
                    <div class="col-md-12 d-flex flex-wrap">
                        <div class="col-12 col-md-4 row justify-content-center">
                            <div>
                                <img class="card-img-top" src="{{ asset('build/img_02.jpg') }}" alt="img challenge">
                            </div>
                        </div>
                        <div class="col-12 col-md-8 row">
                            <div class="col-md-12 d-flex title-challenge-details">
                                <h2 class="col-12">{{ challenge.title }}</h2>
                            </div>
                            <div class="col-md-12 d-flex flex-wrap time-globals">
                                <div class="d-flex col-12 col-sm-6 justify-content-center">
                                    <div class="icon-global"><i class="fa fa-2x fa-calendar"></i></div>
                                    <div class="heures-challenges">
                                        {% for dates in challenge.challengeDates %}
                                            <label>{{ dates.startDate.format('d M. H:i') }}
                                                - {% if dates.startDate.format('d M') != dates.endDate.format('d M') and dates.endDate.format('H:i') != "00:00" %}{{ dates.endDate.format('d M. H:i') }}{% else %}{{ dates.endDate.format('H:i') }}{% endif %} </label>
                                        {% endfor %}

                                    </div>
                                </div>
                                <div class="d-flex justify-content-end col-12 col-sm-6 justify-content-center">

                                </div>
                            </div>
                            <div class="col-md-12 d-flex flex-wrap">
                                <div class="col-12 col-sm-6 justify-content-center text-center">
                                    <div>
                                        <label class="font-weight-bold">{{ challenge.participations|length }}</label>&nbsp;<label>Challengers</label>
                                    </div>
                                </div>
                                <div class="col-12 col-sm-6 justify-content-center text-center">
                                    <a href="#" class="btn btn-custom btn-grey">{{ challenge.typeStr }}</a>

                                    <div>
                                        {# <label class="font-weight-bold">Vainqueur #}
                                        {# :</label>&nbsp;<label>Resuprobe</label> #}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12 d-flex flex-wrap encart-global">

                                <div class="col-12 col-lg-8 text-center">
                                    {% if is_granted('ROLE_USER') %}
                                        {% set participation = app.user.participation(challenge) %}
                                        {% if participation is not null %}
                                            {% if participation.enabled %}
                                                <a href="#" class="btn btn-custom btn-green">Votre inscription est
                                                    validée</a>
                                            {% else %}
                                                <a href="#" class="btn btn-custom btn-grey">Votre inscription est en
                                                    attente de validation</a>
                                            {% endif %}
                                        {% else %}
                                            {# {{ form(form) }} #}
                                            <a href="#" class="btn btn-custom btn-green active">Inscription</a>
                                        {% endif %}
                                    {% else %}
                                        Vous devez être connecté pour vous inscrire.
                                    {% endif %}
                                </div>
                                {# Pour un bouton d'infos (non actif) ne pas lui mettre la classe "active"} #}
                                {#
                                <a href="#" class="btn btn-custom btn-grey active">Bouton actif gris</a>
                                <a href="#" class="btn btn-custom btn-red">Bouton non actif rouge</a>
                                <a href="#" class="btn btn-custom btn-green active">Bouton actif vert</a>
                                #}
                                <div class="col-12 col-lg-4 text-right">
                                    <a href="#"
                                       class="btn btn-custom btn-red"><label>{{ challenge.cashPrize }}</label>&nbsp;<label>euros</label></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        {# infos detailles #}
        <section class="section-parallax static challenge-details">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        {# --- Onglets --- #}
                        <ul class="nav nav-tabs" id="myTab" role="tablist">
                            <li class="nav-item">
                                <a class="nav-link active" id="presentation-tab" data-toggle="tab" href="#presentation"
                                   role="tab" aria-controls="presentation" aria-selected="true">Présentation</a>
                            </li>

                            <li class="nav-item">
                                <a class="nav-link" id="reglement-tab" data-toggle="tab" href="#reglement" role="tab"
                                   aria-controls="reglement" aria-selected="false">Règlement</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="infos-tab" data-toggle="tab" href="#participants" role="tab"
                                   aria-controls="infos" aria-selected="false">Participants</a>
                            </li>
                        </ul>
                        {# --- Contenu onglets --- #}
                        <div class="tab-content" id="tab-content-challenge">
                            {# Onglet présentation #}
                            <div class="tab-pane fade show active" id="presentation" role="tabpanel"
                                 aria-labelledby="presentation-tab">
                                {{ challenge.description|raw }}
                            </div>
                            {# Onglet Infos #}
                            <div class="tab-pane fade row" id="participants" role="tabpanel"
                                 aria-labelledby="infos-tab">
                                <div class="row">
                                    {% for participant in challenge.participations %}
                                        <div class="col-md-3 col-12 mb-2" >
                                            <a href="#" onclick="alert('Bientôt disponible.');" class="d-block p-4" style="border: 1px solid #d3d3d3 ">{{ participant.user.username }}</a>
                                        </div>
                                    {% endfor %}
                                </div>
                            </div>
                            {# Onglet Règlement #}
                            <div class="tab-pane fade" id="reglement" role="tabpanel" aria-labelledby="reglement-tab">
                                {% set type = null %}
                                <ul>
                                    {% for rule in challenge.rules %}
                                    {% if type != rule.type %}
                                </ul>
                                <h2>{{ rule.typeStr }}</h2>
                                <ul>
                                    {% set type = rule.type %}

                                    {% endif %}
                                    <li>{{ rule.label }}</li>
                                    {% endfor %}
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>
{% endblock %}